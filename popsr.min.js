function loadingPopsr(a,b){if($(".popsr."+a).length)$(".popsr."+a+" #loadingText").html(b);else{var c=new popsr(popsrLoadingText('<input type="hidden" id="popsrClose" value="2" />İşlemleriniz tamamlanırken lütfen bekleyin.'),{setName:a,modal:!0,closeButton:!1});$("#loadingText",c).html(b)}}function popsr_close(){$(".popsr").length&&$(".popsr").remove(),$(".popsr-modal").length&&$(".popsr-modal").remove(),history.pushState("",document.title,window.location.pathname+window.location.search)}function popsrLoadingText(a){return'<div align="center" style="min-width:150px; width:100%; text-align:center;"><b>'+a+"</b><br /><div class='loading2' <div id=\"loadingText\"></div></div>"}function popsr(a,b){function i(){return(!$(".popsr-content #popsrClose").length||"3"!=$(".popsr-content #popsrClose").val())&&(!(!$(".popsr-content #popsrClose").length||"2"!=$(".popsr-content #popsrClose").val())||!!($(".popsr-content textarea").length&&$(".popsr-content textarea").val().length>5||"1"==$(".popsr-content #popsrClose").val())&&($(".popsr.lostinfo").length||new popsr("Formu tamamlamadınız, işleminizi iptal etmek istediğinize emin misiniz?",{padding:"10px",titleClass:"anim",title:"Eksik Bilgi",setName:"lostinfo",closeButton:!0,buttons:[{id:0,label:"Evet",val:"1"},{id:1,label:"Hayır",val:"0"}],modal:!0,callback:function(a){1==a&&c.hide()}}),!0))}$("#popsr"+popsrCount).length&&popsrCount++;var c=this;if(c.options=$.extend({},popsr.prototype.options,b||{}),c.popsr=$(c.template()),"loading"==a&&(a=popsrLoadingText("Loading...")),c.setContent(a),c.options.transparent=null!=c.options.transparent&&""!=c.options.transparent&&c.options.transparent?" tbg":"",null==c.options.title)$(".popsr-titlebox",c.popsr).remove();else{if(null==c.options.titleLink?$(".popsr-title",c.popsr).append(c.options.title):$(".popsr-title",c.popsr).append('<a href="'+c.options.titleLink+'">'+c.options.title+"</a>"),(0===c.options.buttons.length&&!c.options.autoclose||c.options.closeButton)&&c.options.closeButton){var d=$('<span class="popsr-closebtn"></span>');d.bind("click",function(){c.hide()}),$(".popsr-titlebox",this.popsr).prepend(d)}if(null!=c.options.titleClass?$(".popsr-titlebox",this.popsr).addClass(c.options.titleClass):$(".popsr-titlebox",this.popsr).addClass("anim"),null!=c.options.myposition){c.options.myposition}else;}if(null!=c.options.width&&$(".popsr-box",c.popsr).css("max-width",c.options.width),c.options.buttons.length>0)for(var f=0;f<c.options.buttons.length;f++){var g=c.options.buttons[f].class?c.options.buttons[f].class:"",h=$('<div class="btnbox"><button id="" class="button00 '+g+'" href="#">'+c.options.buttons[f].label+"</button></div>").data("value",c.options.buttons[f].val);h.bind("click",function(){var a=$.data(this,"value"),b=null!=c.options.callback?function(){c.options.callback(a)}:null;c.hide(b)}),$(".popsr-actions",this.popsr).append(h)}else $(".popsr-footbox",this.popsr).remove();if(0===c.options.buttons.length&&null==c.options.title&&!c.options.autoclose&&c.options.closeButton){var d=$('<span class="popsr-closebtn"></span>');d.bind("click",function(){c.hide()}),$(".popsr-content",this.popsr).prepend(d)}return c.modal=c.options.modal?$('<div id="popsr-modal'+popsrCount+'" class="popsr-modal"></div>').css({opacity:c.options.modalOpacity,width:"100%",height:"100%","z-index":c.options.zIndex+$(".popsr").length}).appendTo(document.body):null,c.options.show&&(c.show(),$(".btnbox button").focus()),$(document).keyup(function(a){27===a.keyCode&&0==i()&&c.hide()}),$(c.modal).bind("click",function(a){0==i()&&c.hide()}),$(window).on("resize",function(a){c.resize()}),$(c.popsr).bind("contentchange",function(a){c.resize(),c.resize()}),null!=c.options.autoclose&&setTimeout(function(a){a.hide()},c.options.autoclose,this),c}function linkPopsr(a){$(a).each(function(a,b){$(b).unbind("click",function(){linkPopsrOpen(b)}).bind("click",function(){linkPopsrOpen(b)})})}function linkPopsrOpen(a){if($(a).data("det"))var b=$(a).data("det");else var b={modal:!1};if("1"==$(a).attr("popsr"))var c=$(a).attr("href");else var c=$(a).attr("popsr");c=c.replace("#",""),$(a).data("id")?(b.setName="popsr_"+$(a).data("id"),$(".popsr_"+$(a).data("id")).length||new popsr.load(addUrlParam(c,"psr","1"),b)):new popsr.load(addUrlParam(c,"psr","1"),b)}function linkPopsrCheck(){$(document).ready(function(){$('a[popsr="1"]').unbind("click").click(function(){linkPopsrOpen(this)})})}function popsr_center(a){$(a).closest(".popsr-content").trigger("contentchange")}var popsrCount=0;popsr.prototype={options:{transparent:!1,timeout:15e3,setName:"",autoclose:null,buttons:[],callback:null,closeback:null,center:!0,closeButton:!0,height:"auto",title:null,titleClass:null,modal:!0,modalOpacity:.6,padding:"0",paddingTop:"0",paddingBottom:"0",paddingLeft:"0",paddingRight:"0",dontClose:!1,show:!0,viewport:{top:"0px",left:"0px"},width:"auto",zIndex:9998,maxHeight:650},template:function(){return'<div class="popsr '+this.options.transparent+" "+this.options.setName+'" id="popsr'+popsrCount+'"><div class="popsr-box '+this.options.transparent+'"><div class="popsr-wrapper '+this.options.transparent+'"><div class="popsr-titlebox noselect"><div class="popsr-title"></div></div><div class="popsr-content"></div><div class="popsr-footbox"><div class="popsr-actions"></div></div></div></div></div>'},content:"<div></div>",visible:!1,setContent:function(a){"object"!==jQuery.type(a)&&("undefined"!=typeof a?a.length&&a.replace(/(<([^>]+)>)/gi,"").length<75&&(a='<div class="popsr-inform">'+a+"</div>"):a='<div class="popsr-inform">Error</div>'),$(".popsr-content",this.popsr).css({"padding-bottom":this.options.paddingBottom,"padding-top":this.options.paddingTop,"padding-left":this.options.paddingLeft,"padding-right":this.options.paddingRight,height:this.options.height}).empty().append(a).trigger("contentchange"),"0"!=this.options.padding&&$(".popsr-content",this.popsr).css({padding:this.options.padding})},viewport:function(){return"undefined"==typeof myposition||"fixed"==myposition?vartop=($(window).height()-this.popsr.height())/2+"px":vartop=($(window).height()-this.popsr.height())/2+$(window).scrollTop()+"px",{top:vartop,left:($(window).width()-this.popsr.width())/2+$(window).scrollLeft()+"px"}},show:function(){this.visible||(this.options.modal&&null!=this.modal&&this.modal.show(),this.popsr.appendTo(document.body),this.options.center&&(this.options.viewport=this.viewport($(".popsr-box",this.popsr))),this.options.viewport.left.replace("px","")<0?this.popsr.css({top:this.options.viewport.top,left:"5%",maxWidth:"90%"}):(this.popsr.css({top:this.options.viewport.top,"z-index":this.options.zIndex+$(".popsr").length}).show().css({opacity:1}),this.popsr.css({left:this.options.viewport.left})),this.popsr.css({"z-index":this.options.zIndex+$(".popsr").length}).show().css({opacity:1}),this.visible=!0)},hide:function(a){if(this.visible){var b=this;return this.popsr.animate({top:"-"+this.popsr.height()+"px",width:"50px",height:"50px"},300,function(){b.popsr.remove(),a&&a.call(),$(window).unbind("resize",function(){b.resize()}),$(".popsr").length||history.pushState("",document.title,window.location.pathname+window.location.search)}),b.options.modal&&null!=b.modal&&$(b.modal).fadeOut("slow",function(){$(this).remove()}),null!=b.options.closeback&&b.options.closeback(),this}},resize:function(){var a=this;if(this.options.modal&&null!=this.modal&&$(".popsr-modal",this.modal).css({width:"100%",height:"100%"}),this.options.center){$(".popsr-content",this.popsr),$(".popsr-content",this.popsr).height();$(".popsr-content",this.popsr).css("height","auto");var d=0;this.options.buttons.length>0&&(d-=$(".popsr-footbox",this.popsr).height()),null!=this.options.title&&(d-=$(".popsr-titlebox",this.popsr).height());var e=$(window).height()+d-20*$(window).height()/100;$(".popsr-content",this.popsr).css({height:$(".popsr-content",this.popsr).height()+"px"}),this.popsr.height()>$(window).height()?$(".popsr-content",this.popsr).css({height:e+"px"}):$(".popsr-content",this.popsr).css({height:$(".popsr-content",this.popsr).height()+"px"}),this.options.viewport=this.viewport($(".popsr-box",this.popsr)),this.options.viewport.left.replace("px","")<0?this.popsr.css({top:this.options.viewport.top,left:"5%",maxWidth:"90%"}):this.popsr.css({top:this.options.viewport.top,left:this.options.viewport.left})}!a.options.dontClose&&($(".popsr-content #alert",this.popsr).length||$(".popsr-content",this.popsr).html().length<75&&a.options.buttons.length<1)&&setTimeout(function(){a.hide()},3e3)},toggle:function(){return this[this.visible?"hide":"show"](),this}},$.extend(popsr,{alert:function(a,b,c){var d=[{id:"ok",label:"OK",val:"OK"}];return c=$.extend({closeButton:!1,buttons:d,callback:function(){}},c||{},{show:!0,closeback:b}),new popsr(a,c)},ask:function(a,b,c){var d=[{id:"yes",label:"Yes",val:"Y",class:"btn-success"},{id:"no",label:"No",val:"N",class:"btn-danger"}];return c=$.extend({closeButton:!1,modal:!0,buttons:d,callback:function(){}},c||{},{show:!0,callback:b}),new popsr(a,c)},img:function(a,b){var c=$(new Image).attr("src",""+a);$(c).load(function(){var a={width:$(window).width()-50,height:$(window).height()-50},d=this.width>a.width||this.height>a.height?Math.min(a.width/this.width,a.height/this.height):1;$(c).css({width:this.width*d,height:this.height*d}),b=$.extend(b||{},{show:!0,closeButton:!0,width:this.width*d,height:this.height*d,padding:0}),new popsr(c,b)}).error(function(){console.log("Error loading "+a)}).attr("src",a)},img2:function(a,b){var c="<img class='popsrimg2' src='"+a+"' style='max-height:300px; max-width:auto;' border='0' />";console.debug(a);var d={width:$(window).width()-50,height:$(window).height()-50},e=this.width>d.width||this.height>d.height?Math.min(d.width/this.width,d.height/this.height):1;$(c).css({width:this.width*e,height:this.height*e}),b=$.extend(b||{},{show:!0,transparent:" tbg",closeButton:!0,width:this.width*e,height:this.height*e,padding:0}),new popsr(c,b),window.setTimeout(function(){popsr_center($(".popsrimg2"))},100)},json:function(a,b){b=$.extend(b||{},{show:!0,params:{}});var c=new popsr("loading",b);return $.ajax({type:"POST",data:b.data,url:a,async:!1,dataType:"json",timeout:b.timeout,cache:!1,error:function(a,b,c){console.debug(a.responseText),console.debug(c),popsr_close(),new popsr("Connection error. Please try again later.",{autoclose:2e3})},success:function(a){if("undefined"!=typeof a.redirect)location.href=URL+a.redirect,popsr_close();else if("undefined"==typeof a.content||0==a.content.length)c.hide();else if($(".popsr-content").length?c.setContent(a.content):c=new popsr(a.content,b),$(".popsr-content img").length){var d=0;$(".popsr-content img").load(function(){d++,d==$(".popsr-content img").length&&c.resize()})}}})},load:function(a,b){b=$.extend(b||{},{show:!0,params:{}});var c=new popsr("loading",b);$.ajax({type:"POST",data:b.data,url:a,timeout:b.timeout,cache:!1,error:function(a,b,c){console.debug(a.responseText),console.debug(c),popsr_close(),new popsr("Connection error, please try again.",{autoclose:2e3})},success:function(a){if($(".popsr-content").length?c.setContent(a):c=new popsr(a,b),0==a.length)c.hide();else if($(".popsr-content img").length){var d=0;$(".popsr-content img").load(function(){d++,d==$(".popsr-content img").length&&c.resize()})}}})},update:function(a,b){b=$.extend(b||{},{show:!0,params:{}}),$(a).length&&($(a).attr("data-oldvalue",$(a).val()),$(a).addClass("popsr-Update"),$(a).mouseover(function(){$(a).addClass("popsr-UpdateMO")}),$(a).mouseout(function(){$(a).removeClass("popsr-UpdateMO")}),$(a).focus(function(){$(a).addClass("popsr-UpdateActive")}),$(a).blur(function(){$(a).removeClass("popsr-UpdateActive")}),$($(a)).keyup(function(b){13==b.which?$(a).blur():27==b.which&&($(a).val($(a).attr("data-oldvalue")),$(a).blur())}),$(a).blur(function(){if($(a).attr("data-oldvalue")!=$(a).val()){var c=new popsr("loading",b);popsr_update=$.ajax({type:"POST",dataType:"json",data:$(a).serialize(),url:addParameterToURL($(a).data("popsr-update-url"),token_querystring),timeout:b.timeout,cache:!1,error:function(a,b,c){console.debug(a.responseText),console.debug(c),popsr_close(),new popsr("Connection error, please try again.",{autoclose:2e3})},success:function(d){if(console.debug(d),"undefined"!=typeof d.redirect)location.href=URL+d.redirect,popsr_close();else{if("undefined"==typeof d.content||0==d.content.length)c.hide();else if($(".popsr-content").length?c.setContent(d.content):c=new popsr(d.content,b),$(".popsr-content img").length){var e=0;$(".popsr-content img").load(function(){e++,e==$(".popsr-content img").length&&c.resize()})}1==d.result?$(a).attr("data-oldvalue",$(a).val()):($(a).val($(a).attr("data-oldvalue")),c.setContent(d.content))}}})}}))}}),$(document).ajaxComplete(function(){linkPopsrCheck()});